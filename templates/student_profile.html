{% include 'header.html' %}
<body>
    {% include 'top_menus.html' %}
    
    <div class="container mx-auto px-4 py-8">
        <!-- Header Section -->
        <div class="mb-8 animate__animated animate__fadeInDown">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold gradient-text mb-2">
                        <i class="fas fa-user-circle mr-3"></i>My Profile
                    </h1>
                    <p class="text-gray-600">View and update your personal information</p>
                </div>
                <button onclick="toggleEditMode()" 
                        class="ripple bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center group">
                    <i class="fas fa-edit mr-2 group-hover:rotate-12 transition-transform duration-300"></i>
                    Edit Profile
                </button>
            </div>
        </div>

        <!-- Profile Card -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column - Personal Info -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <!-- Profile Header -->
                    <div class="flex items-center border-b pb-6 mb-6">
                        <div class="relative">
                            <div class="w-32 h-32 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white text-4xl font-bold border-4 border-white shadow-lg">
                                {{ student.name[0] if student.name else 'S' }}
                            </div>
                            <div class="absolute -bottom-2 -right-2 w-10 h-10 bg-green-500 rounded-full border-4 border-white flex items-center justify-center">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                        </div>
                        <div class="ml-6">
                            <h2 class="text-2xl font-bold text-gray-900">{{ student.name }}</h2>
                            <p class="text-gray-600">{{ student.admission_no }}</p>
                            <div class="flex items-center mt-2">
                                <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium mr-3">
                                    Class {{ student.class }}
                                </span>
                                <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium">
                                    Section {{ student.section }}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Personal Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Basic Info -->
                        <div>
                            <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                <i class="fas fa-info-circle mr-2 text-blue-600"></i>
                                Basic Information
                            </h3>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-venus-mars text-blue-600"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Gender</p>
                                        <p class="font-medium">{{ student.gender|title if student.gender else 'Not specified' }}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-birthday-cake text-blue-600"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Date of Birth</p>
                                        <p class="font-medium">{{ student.dob|datetimeformat('%Y-%m-%d') if student.dob else 'Not specified' }}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-calendar-alt text-blue-600"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Academic Year</p>
                                        <p class="font-medium">{{ student.academic_year }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Info -->
                        <div>
                            <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                <i class="fas fa-address-book mr-2 text-green-600"></i>
                                Contact Information
                            </h3>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-phone text-green-600"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Mobile Number</p>
                                        <p class="font-medium">{{ student.mobile if student.mobile else 'Not specified' }}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-envelope text-green-600"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Email Address</p>
                                        <p class="font-medium">{{ student.email if student.email else 'Not specified' }}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-home text-green-600"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Address</p>
                                        <p class="font-medium">{{ student.current_address if student.current_address else 'Not specified' }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Edit Form (Initially Hidden) -->
                    <div id="editForm" class="hidden mt-8 border-t pt-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Update Profile</h3>
                        <form method="post" action="{{ url_for('student_profile') }}" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="group">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                    <input type="email" name="email" value="{{ student.email or '' }}"
                                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                                <div class="group">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Mobile</label>
                                    <input type="tel" name="mobile" value="{{ student.mobile or '' }}"
                                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                            </div>
                            <div class="group">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                                <textarea name="address" rows="3"
                                          class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ student.current_address or '' }}</textarea>
                            </div>
                            <div class="group">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Change Password</label>
                                <input type="password" name="new_password" placeholder="Leave blank to keep current"
                                       class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div class="flex justify-end space-x-3">
                                <button type="button" onclick="toggleEditMode()"
                                        class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                    Cancel
                                </button>
                                <button type="submit"
                                        class="px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700">
                                    Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Right Column - Stats & Guardian Info -->
            <div class="space-y-6">
                <!-- Academic Stats -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                        <i class="fas fa-chart-line mr-2 text-purple-600"></i>
                        Academic Stats
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-sm text-gray-600">Attendance</span>
                                <span class="text-sm font-bold text-blue-600">{{ attendance_rate|default('0') }}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full" 
                                     style="width: {{ attendance_rate|default('0') }}%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-sm text-gray-600">Assignments Submitted</span>
                                <span class="text-sm font-bold text-green-600">{{ assignments_submitted }}/{{ total_assignments }}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-green-500 to-emerald-600 h-2 rounded-full" 
                                     style="width: {{ (assignments_submitted/total_assignments*100)|default('0')|int }}%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-sm text-gray-600">Overall Grade</span>
                                <span class="text-sm font-bold text-yellow-600">{{ overall_grade|default('N/A') }}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-yellow-500 to-orange-600 h-2 rounded-full" 
                                     style="width: {{ grade_percentage|default('0') }}%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Guardian Information -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                        <i class="fas fa-users mr-2 text-orange-600"></i>
                        Guardian Information
                    </h3>
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-male text-orange-600"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">Father</p>
                                <p class="font-medium">{{ student.father_name if student.father_name else 'Not specified' }}</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-female text-pink-600"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">Mother</p>
                                <p class="font-medium">{{ student.mother_name if student.mother_name else 'Not specified' }}</p>
                            </div>
                        </div>
                        {% if student.father_mobile or student.mother_mobile %}
                        <div class="pt-4 border-t">
                            <p class="text-sm text-gray-500 mb-2">Emergency Contacts</p>
                            {% if student.father_mobile %}
                            <div class="flex items-center text-sm">
                                <i class="fas fa-phone text-gray-400 mr-2"></i>
                                <span>{{ student.father_mobile }}</span>
                            </div>
                            {% endif %}
                            {% if student.mother_mobile %}
                            <div class="flex items-center text-sm mt-1">
                                <i class="fas fa-phone text-gray-400 mr-2"></i>
                                <span>{{ student.mother_mobile }}</span>
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleEditMode() {
            const editForm = document.getElementById('editForm');
            if (editForm.classList.contains('hidden')) {
                editForm.classList.remove('hidden');
                editForm.classList.add('animate__animated', 'animate__fadeIn');
            } else {
                editForm.classList.add('hidden');
            }
        }
    </script>
</body>
{% include 'footer.html' %}